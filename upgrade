apt-get upgrade && apt-get update -y
sudo apt install gcc g++ pkg-config libssl-dev make wabt jq

#install rust https://www.rust-lang.org/tools/install
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh    

git clone https://github.com/CasperLabs/casper-node.git

cd casper-node

git fetch

git checkout release-0.9.3

make setup-rs && make build-client-contracts -j

sudo -u casper /etc/casper/pull_casper_node_version.sh 1_0_1 delta-11
sudo -u casper /etc/casper/config_from_example.sh 1_0_1

cat /etc/casper/1_0_1/chainspec.toml | grep activation_point

/var/lib/casper/bin/1_0_1/casper-node --version

sudo systemctl stop casper-node-launcher
sudo logrotate -f /etc/logrotate.d/casper-node
sudo -u casper /etc/casper/pull_casper_node_version.sh 1_0_2 delta-11
sudo -u casper /etc/casper/config_from_example.sh 1_0_2
sudo -u casper cp /var/lib/casper/bin/1_0_2/casper-node /var/lib/casper/bin/1_0_1
sudo -u casper sed -i 's/1\.0\.1/1\.0\.2/g' /etc/casper/casper-node-launcher-state.toml
sudo -u casper sed -i 's/1_0_1/1_0_2/g' /etc/casper/casper-node-launcher-state.toml
sudo systemctl start casper-node-launcher

watch -n 15 'curl -s localhost:8888/status | jq .last_added_block_info; systemctl status casper-node-launcher; sudo tail /var/log/casper/casper-node.stderr.log'
